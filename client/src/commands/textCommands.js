const {menu_btn} = require('../models/buttons');
const {User, Auth} = require('../api/controller/index');
  

function readCommandsText(bot){
    bot.command('start', async (ctx) => {
        let Users = new User();
        let user = await Users.getByUsername(ctx.chat.username);
        if(user === undefined){
            await Auth.register(ctx.chat.username);
            await ctx.reply('–ü—Ä–∏–≤—ñ—Ç!ü§ó\n–í—ñ—Ç–∞—é, –¥—Ä—É–∂–µüòä. –†–∞–¥–∏–π —Ç–µ–±–µ –±–∞—á–∏—Ç–∏ —Ç—É—Çüòâ');
            await ctx.reply('–ë–∞—á—É —Ç–∏ —É –Ω–∞—Å –≤–ø–µ—Ä—à–µ —ñ –º–∏ –ø—Ä–æ —Ç–µ–±–µ –º–∞–ª–æ —â–æ –∑–Ω–∞—î–º–æüòï\n–©–æ –∂ –¥–∞–≤–∞–π —Ü–µ –≤–∏–ø—Ä–∞–≤–∏–º–æüòâ\n–°–ø–µ—Ä—à—É —è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—é —Å–µ–±–µ, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–π–∂–µ–º–æ –¥–æ —Ç–µ–±–µüòä\n–ú–µ–Ω–µ –∑–≤—É—Ç—å Fastik, —è –±–æ—Ç —è–∫–∏–π –¥–æ–ø–æ–º–æ–∂–µ —Ç–æ–±—ñ –∑–∞–º–æ–≤–∏—Ç–∏ —Ç–µ, —â–æ —Ç–∏ –±–∞–∂–∞—î—à, –Ω–µ–≤–∞–∂–ª–∏–≤–æ, —á–∏ —Ü–µ –Ω—ñ—á, —á–∏ —Ü–µ –¥–µ–Ω—å. –Ø –Ω–∞–¥–∞—é —Ç–æ–±—ñ —É—Å—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ, —è–∫—ñ –¥–æ–ø–æ–º–æ–∂—É—Ç—å —Ç–æ–±—ñ –≤—Å–µ –∑–∞–º–æ–≤–∏—Ç–∏ –≤ –¥–µ–∫—ñ–ª—å–∫–∞ –∫–ª—ñ–∫—ñ–≤ —ñ —à–≤–∏–¥–µ–Ω—å–∫–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–≤–æ—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –¢–µ–ø–µ—Ä –¥–∞–≤–∞–π –¥—ñ–∑–Ω–∞—î–º–æ—Å—å –ø—Ä–æ —Ç–µ–±–µ –¥–µ—â–æü§ó');
            await ctx.scene.enter('setNumber');
        }else{
            await ctx.reply('–ü—Ä–∏–≤—ñ—Ç!ü§ó\n–í—ñ—Ç–∞—é, –¥—Ä—É–∂–µüòä. –†–∞–¥–∏–π —Ç–µ–±–µ –±–∞—á–∏—Ç–∏ —Ç—É—Çüòâ');
            if(user.pnumber === ""){
                await ctx.reply('–ë–∞—á—É, —â–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫ –∫–æ–ª–∏ —Ç–∏ –≤–≤–æ–¥–∏–≤ —Å–≤—ñ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—Éüòï\n–©–æ –∂ –¥–∞–≤–∞–π —Ü–µ –≤–∏–ø—Ä–∞–≤–∏–º–æüòâ');
                await ctx.scene.enter('setNumber');
            }else if(user.client_name === ""){
                await ctx.reply('–ë–∞—á—É —Ç–∏ –Ω–µ –≤–∫–∞–∑–∞–≤ —Å–≤–æ—î —ñ–º\'—èüòï\n–©–æ –∂ –¥–∞–≤–∞–π —Ü–µ –≤–∏–ø—Ä–∞–≤–∏–º–æüòâ');
                await ctx.scene.enter('setName');
            }else{
                await ctx.reply('–û–±–µ—Ä–∏ –ø—É–Ω–∫—Ç —É –º–µ–Ω—é —è–∫–∏–π —Ç–æ–±—ñ –¥–æ –≤–ø–æ–¥–æ–±–∏, —â–æ–±–∏ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–æ—éüòå', {reply_markup: menu_btn});
            }
        }
    }); 
}

module.exports = readCommandsText;